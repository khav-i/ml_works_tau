# Классификация сигналов оптомиографических датчиков

В данной работе мы будем решать задачу из соревнования на
[Kaggle](https://www.kaggle.com/competitions/motorica-skillfactory-internship-test-task-2023-12/overview).
Она заключается в классификации непрерывных команд от пользователя на основе данных, полученных от оптомиографических датчиков.

Необходимо построить модель распознавания жестов в парадигме обучения с учителем. Параметры модели должны быть оптимизированы
на предложенных данных для обучения. Валидация модели должна произведиться на отложенной тестовой выборке на платформе
соревнования.

## Метрика оценки качества решения

В качестве метрики оценки качества решения выбран Mean F-score.

## Подход сбора данных

*Пилот* - человек, с которого собираются данные.

На руку пилота крепится манжета с датчиками, которые фиксируют движение мышц и связок руки пилота. В течение всей процедуры сбора данных зафиксированные датчиками данные записываются в файл.
Пилоту поступают команды о выполнении жестов, пилот после получения команды с некоторой естественной задержкой выполняет жесты.

![image](https://github.com/khav-i/ml_works_tau/assets/126453765/c5d552df-d546-458d-b1fc-f9e4dd82ec78)

## Данные
Данные представляют из себя временные ряды, где в каждый момент времени фиксируются показания от датчиков.
Целевая переменная представляет из себя закодированную команду поданную пользователю на выполнение жеста в каждый момент времени.

## Содержание работы

- Загрузка и преобразование данных
  * Исходный вид
  * Сглаживание, разложение и стандартизация данных
  * Устранение мультиколлинеарности
- Модели решения задачи классификации
  * Baseline model. LogisticRegression
  * GaussianNB
  * KNeighborsClassifier
  * LinearSVC
  * SVC
  * SGDClassifier
  * MLPClassifier
  * DecisionTreeClassifier
  * RandomForestClassifier
  * HistGradientBoostingClassifier
  * XGBClassifier
  * CatBoostClassifier
  * Селекция
  * StackingClassifier
- Предсказание на тестовой выборке
  * Переход от исходного вида к kaggle
- Визуализация результата моделирования

## Результат

У нас получилось объединить несколько неплохо себя порекомендовавших алгоритмов в одну стэкинг-модель со следующими метриками
на кросс-валидации (основа: треннировочная выборка):

![image](https://github.com/khav-i/ml_works_tau/assets/126453765/c64b858a-20b7-4bdb-9281-f23c7ff1bc68)

Визуальная оценка качества модели подтвердило наличие некоторых аномалий:

![image](https://github.com/khav-i/ml_works_tau/assets/126453765/70dc1dd9-294b-4a7e-bb62-c27b33ab6887)

В 42-м испытании, как мы видим, присутствуют колебания на отрезке 0-20: скорее всего, это ошибки нашей модели. В
наших предсказаниях всего 9 из 53 серий испытаний имеют подозрительные колебания в графике: по большей части это
одиночные пики, 42-й ряд зашумлен сильнее прочих.

Также значение метрики на платформе:

![image](https://github.com/khav-i/ml_works_tau/assets/126453765/262afb00-84d9-44cd-96f0-cee06a9ee01b)

Получилось несколько хуже, чем результат модели на алгоритме CatBoostClassifier с дефолтными параметрами:

![image](https://github.com/khav-i/ml_works_tau/assets/126453765/6db9a723-2f01-4ed8-80c0-5b5a774a3644)

Соревнование уже завершено, но задача не перестает нас вдохновлять на поиски лучшего решения! Особенно тогда, когда из 9 мест
на лидерборде тебе принадлежит почетное шестое :) 

Без верно приложенных усилий себя не превзойти. И прилагая их, мы не без основания верим, что обязательно станем лучше!

## [Тетрадка с решением](https://github.com/khav-i/ml_works_tau/blob/master/Classification%20of%20OMG-sensors%20signals/motorika.ipynb)
